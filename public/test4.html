<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ¤– Grok Mirror</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
            color: #333;
        }
        .header { text-align: center; margin-bottom: 30px; }
        .status, .accounts, .config { margin-bottom: 30px; }
        .status-box, .config-box {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .account-selector { margin: 20px 0; }
        button {
            padding: 10px;
            font-size: 16px;
            border-radius: 5px;
            border: none;
            background: #1d9bf0;
            color: white;
            cursor: pointer;
        }
        button:hover { background: #1a8cd8; }
        .loading { display: none; text-align: center; padding: 20px; }
    </style>
</head>
<body>
    <div class="header">
        <h1>ğŸŒ™ ğŸ¤– Grok Mirror</h1>
        <p>åŸºäºDenoçš„é«˜æ€§èƒ½Grokä»£ç†æœåŠ¡</p>
    </div>

    <div class="status">
        <div class="status-box">
            <h2>æœåŠ¡çŠ¶æ€</h2>
            <p id="status">æ£€æŸ¥æœåŠ¡çŠ¶æ€ä¸­...</p>
            <p id="account-count">è´¦å·: 0/1</p>
        </div>
    </div>

    <div class="accounts">
        <h2>è®¿é—®è´¦å·</h2>
        <div class="account-selector">
            <p>å½“å‰è´¦å·: <strong>ACCOUNT1</strong></p>
            <button onclick="switchAccount()">è®¿é—® ACCOUNT1</button>
        </div>
    </div>

    <div class="config">
        <h2>ğŸ› ï¸ éƒ¨ç½²é…ç½®</h2>
        <div class="config-box">
            <h3>ç¯å¢ƒå˜é‡è®¾ç½®</h3>
            <pre>
ACCOUNT1_COOKIES="your_account1_cookies_here"
PORT=8000
            </pre>
            <h3>æœ¬åœ°è¿è¡Œ</h3>
            <pre>
# è®¾ç½®ç¯å¢ƒå˜é‡
export ACCOUNT1_COOKIES="..."
# è¿è¡ŒæœåŠ¡
deno run --allow-net --allow-read --allow-env main.ts
            </pre>
            <h3>Deno Deploy</h3>
            <pre>
1. Forké¡¹ç›®åˆ°GitHub
2. è¿æ¥åˆ°Deno Deploy
3. è®¾ç½®ç¯å¢ƒå˜é‡
4. è‡ªåŠ¨éƒ¨ç½²å®Œæˆ
            </pre>
            <h3>è·å–Cookies</h3>
            <pre>
1. åœ¨Grokç½‘ç«™ç™»å½•åï¼ŒæŒ‰F12æ‰“å¼€å¼€å‘è€…å·¥å…·
2. æ‰“å¼€Networkæ ‡ç­¾
3. åˆ·æ–°é¡µé¢
4. æ‰¾åˆ°ä»»æ„è¯·æ±‚
5. å¤åˆ¶Cookieè¯·æ±‚å¤´å®Œæ•´å†…å®¹
            </pre>
        </div>
    </div>

    <footer>
        <p>Â© 2025 Grok Mirror - é«˜æ€§èƒ½AIä»£ç†æœåŠ¡</p>
        <p>Built with â¤ï¸ using Deno + TypeScript</p>
    </footer>

    <div id="loading" class="loading">
        <p>è¿æ¥ä¸­ï¼Œè¯·ç¨å€™...</p>
    </div>

    <script>
        // æ£€æŸ¥æœåŠ¡çŠ¶æ€
        async function checkStatus() {
            try {
                const response = await fetch('/api/health');
                const data = await response.json();
                document.getElementById('status').textContent = `æœåŠ¡çŠ¶æ€: ${data.status}`;
                const configuredAccounts = Object.values(data.accounts).filter(acc => acc.configured).length;
                document.getElementById('account-count').textContent = `è´¦å·: ${configuredAccounts}/1`;
            } catch (error) {
                document.getElementById('status').textContent = `æœåŠ¡çŠ¶æ€: é”™è¯¯ - ${error.message}`;
            }
        }

        // è®¿é—®è´¦å·
        async function switchAccount() {
            const account = "account1";
            document.getElementById('loading').style.display = 'block';
            try {
                // æµ‹è¯•è´¦å·è¿æ¥
                const testResponse = await fetch(`/api/test/${account}`);
                const testData = await testResponse.json();
                if (!testData.success) {
                    alert(`è´¦å· ${account} æµ‹è¯•å¤±è´¥: ${testData.message}`);
                    return;
                }

                // é‡å®šå‘åˆ°ä»£ç†è·¯ç”±
                window.location.href = `/proxy?account=${account}&path=/`;
            } catch (error) {
                alert(`è®¿é—®è´¦å·å¤±è´¥: ${error.message}`);
            } finally {
                document.getElementById('loading').style.display = 'none';
            }
        }

        // åˆå§‹åŒ–
        window.onload = checkStatus;
    </script>
</body>
</html>